[gd_resource type="BehaviorTree" load_steps=33 format=3 uid="uid://dyq515m2r40jd"]

[ext_resource type="Script" path="res://ai/tasks/get_first_node_in_group.gd" id="1_6qoec"]
[ext_resource type="Script" path="res://ai/tasks/pursue.gd" id="2_vmhsu"]
[ext_resource type="Script" path="res://ai/tasks/random_dir.gd" id="3_4iyo4"]
[ext_resource type="Script" path="res://ai/tasks/face_target.gd" id="3_6harm"]
[ext_resource type="Script" path="res://ai/tasks/move_to_pos.gd" id="4_qtr7d"]

[sub_resource type="BlackboardPlan" id="BlackboardPlan_3b6hr"]
var/speed/name = &"speed"
var/speed/type = 3
var/speed/value = 0.0
var/speed/hint = 1
var/speed/hint_string = "10,1000,10"

[sub_resource type="BTConsolePrint" id="BTConsolePrint_c624m"]
text = "walking to the player"

[sub_resource type="BTAction" id="BTAction_w4q8e"]
script = ExtResource("1_6qoec")
group = &"player"
output_var = &"target"

[sub_resource type="BBNode" id="BBNode_apnfi"]
saved_value = NodePath("AnimationPlayer")
resource_name = "AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_v5i13"]
animation_player = SubResource("BBNode_apnfi")
animation_name = &"walk"

[sub_resource type="BTAction" id="BTAction_p233m"]
script = ExtResource("2_vmhsu")
target_var = &"target"
speed_var = &"speed"
approach_distance = 30.0

[sub_resource type="BTSequence" id="BTSequence_vvjnn"]
custom_name = "Move To Player"
children = [SubResource("BTConsolePrint_c624m"), SubResource("BTAction_w4q8e"), SubResource("BTPlayAnimation_v5i13"), SubResource("BTAction_p233m")]

[sub_resource type="BTAction" id="BTAction_dhbmn"]
script = ExtResource("3_6harm")
target_var = &"target"

[sub_resource type="BTWait" id="BTWait_pus4l"]
duration = 0.0

[sub_resource type="BTConsolePrint" id="BTConsolePrint_6of2i"]
text = "attack!"

[sub_resource type="BBNode" id="BBNode_pfi0v"]
saved_value = NodePath("AnimationPlayer")
resource_name = "AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_keqog"]
await_completion = 1.1
animation_player = SubResource("BBNode_pfi0v")
animation_name = &"attack1"

[sub_resource type="BTSequence" id="BTSequence_n431p"]
custom_name = "Attack"
children = [SubResource("BTAction_dhbmn"), SubResource("BTWait_pus4l"), SubResource("BTConsolePrint_6of2i"), SubResource("BTPlayAnimation_keqog")]

[sub_resource type="BTSequence" id="BTSequence_gx77r"]
custom_name = "Attacking"
children = [SubResource("BTSequence_vvjnn"), SubResource("BTSequence_n431p")]

[sub_resource type="BTConsolePrint" id="BTConsolePrint_cfqxn"]
text = "idling"

[sub_resource type="BBNode" id="BBNode_bedva"]
saved_value = NodePath("AnimationPlayer")
resource_name = "AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_3dte7"]
animation_player = SubResource("BBNode_bedva")
animation_name = &"idle"

[sub_resource type="BTRandomWait" id="BTRandomWait_8bo1b"]
min_duration = 0.5
max_duration = 1.5

[sub_resource type="BTSequence" id="BTSequence_7u20q"]
custom_name = "Idle Sequence"
children = [SubResource("BTConsolePrint_cfqxn"), SubResource("BTPlayAnimation_3dte7"), SubResource("BTRandomWait_8bo1b")]

[sub_resource type="BTConsolePrint" id="BTConsolePrint_cn7mq"]
text = "random move"

[sub_resource type="BBNode" id="BBNode_ymtit"]
saved_value = NodePath("AnimationPlayer")
resource_name = "AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_xlnb0"]
animation_player = SubResource("BBNode_ymtit")
animation_name = &"walk"

[sub_resource type="BTAction" id="BTAction_dk5rq"]
script = ExtResource("3_4iyo4")
range_min_in_dir = 100
range_max_in_dir = 300
position_var = &"pos"
direction_var = &"dir"

[sub_resource type="BTAction" id="BTAction_kljvh"]
script = ExtResource("4_qtr7d")
target_pos_var = &"pos"
dir_var = &"dir"
speed_var = &"speed"

[sub_resource type="BTSequence" id="BTSequence_xvj4a"]
custom_name = "Random Move Sequence"
children = [SubResource("BTConsolePrint_cn7mq"), SubResource("BTPlayAnimation_xlnb0"), SubResource("BTAction_dk5rq"), SubResource("BTAction_kljvh")]

[sub_resource type="BTSequence" id="BTSequence_fkguu"]
custom_name = "Wandering"
children = [SubResource("BTSequence_7u20q"), SubResource("BTSequence_xvj4a")]

[sub_resource type="BTSelector" id="BTSelector_gtd1m"]
children = [SubResource("BTSequence_gx77r"), SubResource("BTSequence_fkguu")]

[resource]
blackboard_plan = SubResource("BlackboardPlan_3b6hr")
root_task = SubResource("BTSelector_gtd1m")
